<Window x:Class="RdpIo.UI.Windows.RegionSelectionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="rdp-io - Выбор области для OCR"
        WindowStyle="None"
        ResizeMode="NoResize"
        Background="Transparent"
        AllowsTransparency="True"
        Topmost="True"
        Cursor="None"
        ShowInTaskbar="False"
        ForceCursor="True">

    <Grid>
        <!-- Canvas для рисования прямоугольника выделения -->
        <!-- Background делает Canvas "hit-testable" для событий мыши -->
        <Canvas x:Name="SelectionCanvas"
                Background="#80000000"
                MouseLeftButtonDown="Canvas_MouseLeftButtonDown"
                MouseMove="Canvas_MouseMove"
                MouseLeftButtonUp="Canvas_MouseLeftButtonUp">

            <!-- Кастомный курсор (белый крестик с чёрной обводкой) -->
            <Canvas x:Name="CustomCursor" Visibility="Visible">
                <!-- Вертикальная линия (чёрная обводка) -->
                <Line X1="0" Y1="-15" X2="0" Y2="15"
                      Stroke="Black" StrokeThickness="3" />
                <!-- Горизонтальная линия (чёрная обводка) -->
                <Line X1="-15" Y1="0" X2="15" Y2="0"
                      Stroke="Black" StrokeThickness="3" />
                <!-- Вертикальная линия (белая) -->
                <Line X1="0" Y1="-15" X2="0" Y2="15"
                      Stroke="White" StrokeThickness="1" />
                <!-- Горизонтальная линия (белая) -->
                <Line X1="-15" Y1="0" X2="15" Y2="0"
                      Stroke="White" StrokeThickness="1" />
            </Canvas>

            <!-- Прямоугольник выделения -->
            <Rectangle x:Name="SelectionRectangle"
                       Canvas.Left="{Binding SelectionX}"
                       Canvas.Top="{Binding SelectionY}"
                       Width="{Binding SelectionWidth}"
                       Height="{Binding SelectionHeight}"
                       Visibility="{Binding SelectionRectangleVisibility}"
                       Stroke="#27AE60"
                       StrokeThickness="2"
                       Fill="#3027AE60"
                       StrokeDashArray="5,3" />

            <!-- Размеры выделенной области (динамически) -->
            <Border Canvas.Left="{Binding SelectionX}"
                    Canvas.Top="{Binding SelectionY}"
                    Visibility="{Binding SelectionRectangleVisibility}"
                    Background="#CC27AE60"
                    Padding="5,2"
                    CornerRadius="3"
                    Margin="0,-25,0,0">
                <TextBlock Foreground="White"
                           FontSize="11"
                           FontWeight="Bold">
                    <Run Text="{Binding SelectionWidth, StringFormat='{}{0:F0}', Mode=OneWay}"/>
                    <Run Text=" × "/>
                    <Run Text="{Binding SelectionHeight, StringFormat='{}{0:F0}', Mode=OneWay}"/>
                    <Run Text=" px"/>
                </TextBlock>
            </Border>
        </Canvas>

        <!-- Инструкции -->
        <Border VerticalAlignment="Top"
                HorizontalAlignment="Center"
                Margin="0,20,0,0"
                Background="#CC34495E"
                BorderBrush="#27AE60"
                BorderThickness="2"
                CornerRadius="5"
                Padding="20,10">
            <StackPanel>
                <TextBlock Text="Выберите область экрана для распознавания текста"
                           FontSize="16"
                           FontWeight="Bold"
                           Foreground="White"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,5"/>
                <TextBlock Foreground="#BDC3C7"
                           FontSize="12"
                           HorizontalAlignment="Center">
                    <Run Text="Нажмите и перетащите мышь для выделения области"/>
                    <LineBreak/>
                    <Run Text="Esc - отмена"/>
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</Window>
